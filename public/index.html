<!DOCTYPE html>
<html lang="en">
<head>
    <title>Weather App</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>
    <style>
        body {
            padding-top: 60px;
        }

        footer {
            text-align: center;
            font-size: 14px;
            color: #888;
            margin-top: auto;
            position: fixed;
            bottom: 0;
            width: 100%;
        }
        #map {
            height: 400px;
        }
    </style>
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
    <a class="navbar-brand" href="#">Weather App</a>
</nav>

<div class="container mt-5">
    <h1>Weather App</h1>
    <form id="weatherForm">
        <div class="form-group">
            <label for="location">Enter location:</label>
            <input type="text" class="form-control" id="location" name="location" required />
        </div>
        <button type="submit" class="btn btn-primary">Get Weather</button>
    </form>
    <div id="weatherInfo" class="mt-4"></div>
</div>

<div id="map"></div>

<footer class="footer">
    <div class="container">
        <p class="text-muted">Miroshnik Vyacheslav SE-2214</p>
    </div>
</footer>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<script>
    const weatherForm = document.getElementById('weatherForm');
    const weatherInfo = document.getElementById('weatherInfo');

    weatherForm.addEventListener('submit', async (event) => {
        event.preventDefault();
        const formData = new FormData(weatherForm);
        const location = formData.get('location');
        const response = await fetch(`/weather?location=${encodeURIComponent(location)}`);
        const data = await response.json();
        displayWeatherData(data);
    });

    function displayWeatherData(data) {
        weatherInfo.innerHTML = `
            <h2>${data.location}</h2>
            <p>Temperature: ${data.temperature} °C</p>
            <p>Description: ${data.description}</p>
            <img src="http://openweathermap.org/img/w/${data.icon}.png" alt="${data.description}" />
            <p>Longitude: ${data.longitude}</p>
            <p>Latitude: ${data.latitude}</p>
            <p>Feels Like Temperature: ${data.feels_like_temperature} °C</p>
            <p>Humidity: ${data.humidity}%</p>
            <p>Pressure: ${data.pressure} hPa</p>
            <p>Wind Speed: ${data.wind_speed} m/s</p>
            <p>Country code: ${data.country_code}</p>
          `;
        var map = L.map('map').setView([data.latitude, data.longitude], 13);

        L.tileLayer('https://maps.openweathermap.org/maps/2.0/weather/TA2/{z}/{x}/{y}?appid=be087a09b46822e7a2d3e6d142f28810', {
            attribution: '© OpenWeatherMap',
        }).addTo(map);
    }
</script>
</body>
</html>